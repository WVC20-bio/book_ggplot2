#  Additional changes to the design of your plot {#changes-design}

The appearance or design of a graphic includes elements such as labels (titles, subtitles, captions, captions, captions, others), label placement, colors, themes and font styles. Most of these have been developed throughout the book. In this chapter we will focus on the different themes and font styles you can add to your graphics to get the right design.

## Using themes {#theme-plot}

When creating or recreating a figure we can apply different themes to it. There are a variety of themes that are built into ggplot2 and in Figure \@ref(fig:themes) A we present some examples. The `theme_gray()` or `theme_grey()` is the default theme. 
\index{theme\_gray function}
\index{theme\_grey function}

However, there are themes created by other users that are distributed through R packages. For example, the [cowplot](https://wilkelab.org/cowplot/) package, developed by Claus O. Wilke, offers a variety of complementary themes with specific features, among which `theme_cowplot()` is one of my favorites. \index{theme\_cowplot, cowplot}

In addition, we have the ability to create our own theme and in Figure \@ref(fig:themes) B we show custom themes by myself.

(ref:themes) Bar chart with fictitious data. The same figure is shown using different themes: (A) themes embedded in ggplot2, being the default theme_grey(); (B) custom themes from existing themes in ggplot2. 

```{r themes, fig.width = 5.5*6/4.2, fig.asp = 0.7,dpi=300,echo=FALSE,error=FALSE, warning=FALSE, message=FALSE, fig.cap= '(ref:themes)', fig.align='center'}


library(pacman)

pacman::p_load(
        tidyverse,
        aplot)

data <- data.frame(dose=c("A", "B"),
                len=c(10, 25))

p1 <-ggplot(data,aes(   #theme_grey()-default
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(x = "", y = "", 
     title = "theme_gray()") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_gray(base_size = 14) + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold"),
      axis.text = element_text(
      size  = 14
      )) 

p2 <- ggplot(data,aes(   
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(x = "", y = "", 
     title = "theme_minimal()") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_minimal(base_size = 14) + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold"),
      axis.text = element_text(
      size  = 14
      )) 

p3 <- ggplot(data,aes(   
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(x = "", y = "", 
     title = "theme_classic()") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_classic(base_size = 14) + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold"),
      axis.text = element_text(
      size  = 14
      )) 


first_row <-  aplot::plot_list(p1,p2,p3,
        ncol = 3, widths = 20,
         heights = 10,
        labels = ("A"),
        tag_size = 16)

# custom plots

## Theme opctional - N°01

theme_us_bw <- function(base_size  = 14, 
    base_family  = "") {
  color = "grey50"
  line_size = 0.5
  ggplot2::theme_bw(
  base_size = base_size, 
    base_family = base_family
  ) %+replace% 
  theme(
    panel.border = element_rect(
    color = color, fill = NA,
    size = line_size
    ),
    axis.text = element_text( color = color),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks  = element_line(color = color, 
            size = line_size)
  )
}

## Theme optional - N°02

theme_us_hgrid <- function(base_size  = 14, 
                     base_family  = "") {
  color = "grey70"
  line_size = 0.5
  ggplot2::theme_minimal(
  base_size = base_size, 
    base_family = base_family
  ) %+replace%
    theme(panel.grid.major = element_line(
      color = color, 
            size = line_size
    ),
    panel.grid.major.x = element_blank(),
      panel.grid.minor = element_blank(),
      axis.ticks  = element_line(color = color, 
            size = line_size),
    axis.text = element_text(size = 14,
    color = "grey50")
    )
}

## Theme used in the book - N°03

theme_us_classic <- function(base_size  = 14, 
                     base_family  = "") {
  color = "grey50"
  line_size = 0.5
  ggplot2::theme_classic(base_size = base_size, 
    base_family = base_family) %+replace%
    theme(
    axis.text = element_text( color = color), 
    axis.line = element_line(size = line_size
    , color = color),
    axis.ticks = element_line(color = color)
    )
}

g1 <- ggplot(data,aes(   
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(y = "", x = "",
     title = "customized-N°1") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_us_bw() + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold"))


g2 <- ggplot(data,aes(   
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(y = "", x = "",
     title = "customized-N°2") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_us_hgrid() + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold")) 


g3 <- ggplot(data,aes(   
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(y = "", x = "",
     title = "customized-N°3") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_us_classic() + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold")) 


second_row <- aplot::plot_list(g1,g2,g3,
        ncol = 3, widths = 20,
         heights = 10,
        labels = ("B"),
        tag_size = 16)



final_plot <- aplot::plot_list(
               first_row, second_row,
               ncol = 1
               )
final_plot


```

Panel (B) illustrates three customized themes, organized from lowest to highest level of customization: “customized-N°1”, “customized-N°2” and “customized-N°3”. The “customized-N°1” theme adds a border around the chart, which I consider unnecessary, so I tend to avoid using frames in my charts. In the “customized-N°2” theme, a frame is not used, but horizontal grid lines have been incorporated. If you consider that these lines make it easier to interpret the data, you can keep them, making sure that they do not create a visual burden. For this purpose, it is recommended that they be thin and gray in color. Finally, in the “customized-N°3” theme (used in this book), the grid lines have been removed and thin, gray axis lines have been added. In my opinion, this customized theme helps the data stand out more clearly.

Below I show you the codes of the themes:

```{r, warning=FALSE, message=FALSE, error=FALSE,eval=FALSE}


# Theme opctional - N°01

theme_us_bw <- function(base_size  = 14, 
    base_family  = "") {
  color = "grey50"
  line_size = 0.5
  ggplot2::theme_bw(
  base_size = base_size, 
    base_family = base_family
  ) %+replace% 
  theme(
    panel.border = element_rect(
    color = color, fill = NA,
    size = line_size
    ),
    axis.text = element_text( color = color),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks  = element_line(color = color, 
            size = line_size)
  )
}

# Theme optional - N°02

theme_us_hgrid <- function(base_size  = 14, 
                     base_family  = "") {
  color = "grey70"
  line_size = 0.5
  ggplot2::theme_minimal(
  base_size = base_size, 
    base_family = base_family
  ) %+replace%
    theme(panel.grid.major = element_line(
      color = color, 
            size = line_size
    ),
    panel.grid.major.x = element_blank(),
      panel.grid.minor = element_blank(),
      axis.ticks  = element_line(color = color, 
            size = line_size),
    axis.text = element_text(size = 14,
    color = "grey50")
    )
}

# Theme used in the book - N°03

theme_us_classic <- function(base_size  = 14, 
                     base_family  = "") {
  color = "grey50"
  line_size = 0.5
  ggplot2::theme_classic(base_size = base_size, 
    base_family = base_family) %+replace%
    theme(
    axis.text = element_text( color = color), 
    axis.line = element_line(size = line_size
    , color = color),
    axis.ticks = element_line(color = color)
    )
}

```


## Using fonts {#fonts-plot}

In some cases, you may want to change the font used in your graphics. The default font is “TT Arial”, which is an excellent choice. However, if you prefer to use another font, such as “Times New Roman”, you just need to specify it in the `theme_us_classic() `function using the `base_family` argument. \index{theme\_us\_classic, book}


(ref:fnt1) Bar chart with fictitious data. The same figure using different fonts: (A) “Times New Roman” font, (B) “Papyrus” font. 

```{r fnt1, out.width = "0.9\\linewidth", fig.width = 6, fig.asp = 0.6,dpi=300,echo=FALSE,error=FALSE, warning=FALSE, message=FALSE, fig.cap= '(ref:fnt1)', fig.align='center'}
library(pacman)

pacman::p_load(
        tidyverse,
        extrafont,
        aplot)

data <- data.frame(dose=c("A", "B"),
                len=c(10, 25))


p1 <- ggplot(data,aes(   
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(title = "Times New Roman") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_us_classic(base_family = "serif") + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold"))

windowsFonts(`Papyrus` = windowsFont("Papyrus"))
# download and installation: Ghostscript 
# http://www.ghostscript.com/download

Sys.setenv(R_GSCMD = "C:/Program Files/gs/gs10.04.0/uninstgs.exe")


p2 <- ggplot(data,aes(   
  x = dose, y = len
))  + 
geom_col(aes(fill = dose,
             color = dose)
         ,width = 0.5, size = 1) + 
scale_y_continuous(expand = c(0,0),
    limits = c(0,26)) + 
labs(title = "Papyrus") + 
scale_color_manual(values = c(
  "B" =  "#15617b",
  "A" = "#DBBF5A"
)) + 
scale_fill_manual(values = c(
  "B" =  "#15617b80",
  "A" = "#DBBF5A80"
)) + 
theme_us_classic(base_family = "Papyrus") + 
theme(legend.position = "none",
      plot.margin = margin(t = 7, r = 10, 
      b = 2, l = 8),
      plot.title.position = "plot",
      plot.title = element_text(face = "bold"))

aplot::plot_list(p1,p2,ncol = 2,
                 tag_levels = "A",
                  tag_size = 16)

ggsave("plot_ex.pdf", width = 10, height = 8)

```

Before specifying the font, note that R in Windows does not automatically recognize the fonts installed on your computer. To fix this, use the `windowsFonts()` function and note the following:

```{r, warning=FALSE, eval=FALSE}

windowsFonts() # fonts installed on your computer

```

By default, only three fonts are available: Arial (sans), Courier New (mono) and Times New Roman (serif). However, if you wish to add an additional font, you can do so using the function:

`windowsFonts(font_name_in_R = windowsFont(“Actual font name”))`.

For example, to install the “Papyrus” font, we would proceed as follows.

```{r, warning=FALSE}

windowsFonts(`Papyrus` = windowsFont("Papyrus"))

```

By installing the extrafont package, you will have access to a wide variety of fonts, which you can view using the `fonts()` function.

```{r, warning=FALSE, eval=FALSE,error=FALSE}

# install.packages("extrafont")
# download and installation: Ghostscript 
# http://www.ghostscript.com/download

Sys.setenv( #Ghostscript path 
R_GSCMD = "C:/Program Files/gs/gs10.04.0/uninstgs.exe"
)
library(extrafont)

# Find and save information about fonts installed on your system

font_import()

# See what fonts are now available

fonts()

```

The installation of fonts only takes effect in the current RStudio session. Therefore, every time you start a new session, you must load the **extrafont** package and execute the following code: `extrafont::load_fonts()` to have all fonts available. 

However, if you want to save your graphic with your new font in PDF format, you need to perform a few additional steps. You have to download and install [Ghostscript](http://www.ghostscript.com/download), then run the following function `Sys.setenv(R_GSCMD = "C:/Program Files/gs/gs10.04.0/uninstgs.exe")` with the path to the program installed on your computer. 

Next, we will apply what we have learned with an example (Figure \@ref(fig:fnt2)). We will once again use the dataset that analyzes the use of bar charts to represent continuous data (inappropriately) and bar charts that display counts or proportions (appropriately) in articles published between 2010 and 2020 [@Riedel20]. 


(ref:fnt2) Fields categorized into three priority intervention groups to encourage authors to replace bar charts of continuous data with more informative visualizations. The high-priority group includes two subgroups: one subgroup in which more informative graph types are less common, and a second subgroup in which more informative graph types are more commonly used. Training in how to create more informative graphs, and how to choose between dot plots, box plots, violin plots, and histograms may be especially critical for fields where more informative graphs are less common.

```{r fnt2, fig.width = 5.5*6.5/4.2, fig.asp = 0.7,dpi=300,echo=FALSE,error=FALSE, warning=FALSE, message=FALSE, fig.cap= '(ref:fnt2)', fig.align='center'}


library(pacman)
pacman::p_load(
   tidyverse,
   ggtext,
   scales
  )

pmc_results  <- read.csv(file = 
            "data/Chapter11/study_results.csv", 
            header = TRUE,  sep=",")  %>%
  filter(pdf_downloaded) %>%
  mutate(informative = box + dot + hist + violin + bardot) %>%
  mutate(FoR_category = FoR_category %>%
           str_replace("Multidisciplinary", "Multidisciplinary Journals") %>%
           replace_na("Unclassified Journals") %>%
           str_replace("and", "&") %>%
           str_split(" - ") %>%
           map_chr(last))

pmc_results_agg <- pmc_results %>%
  group_by(year, FoR_category) %>%
  summarise(total = n(),
            approp_count = sum(approp > 0, na.rm = TRUE),
            bar_count = sum(bar > 0, na.rm = TRUE),
            bardot_count = sum(bardot > 0, na.rm = TRUE),
            box_count = sum(box > 0, na.rm = TRUE),
            dot_count = sum(dot > 0, na.rm = TRUE),
            irrelevant_flow_count = sum(flowno > 0, na.rm = TRUE),
            flow_count = sum(flowyes > 0, na.rm = TRUE),
            hist_count = sum(hist > 0, na.rm = TRUE),
            other_count = sum(other > 0, na.rm = TRUE),
            pie_count = sum(pie > 0, na.rm = TRUE),
            text_count = sum(text > 0, na.rm = TRUE),
            violin_count = sum(violin > 0, na.rm = TRUE),
            informative_count = sum(informative > 0, na.rm = TRUE),
            informative_only_count = sum(informative > 0 & bar == 0, na.rm = TRUE),
            bar_only_count = sum(bar > 0 & informative == 0, na.rm = TRUE),
            bar_informative_count = sum(bar > 0 & informative > 0, na.rm = TRUE),
            approp_perc = (approp_count/total * 100) %>% round(2),
            bar_perc = (bar_count/total * 100) %>% round(2),
            bardot_perc = (bardot_count/total * 100) %>% round(2),
            box_perc = (box_count/total * 100) %>% round(2),
            dot_perc = (dot_count/total * 100) %>% round(2),
            irrelevant_flow_perc = (irrelevant_flow_count/total * 100) %>% round(2),
            flow_perc = (flow_count/total * 100) %>% round(2),
            hist_perc = (hist_count/total * 100) %>% round(2),
            other_perc = (other_count/total * 100) %>% round(2),
            pie_perc = (pie_count/total * 100) %>% round(2),
            text_perc = (text_count/total * 100) %>% round(2),
            violin_perc = (violin_count/total * 100) %>% round(2),
            informative_perc = (informative_count/total * 100) %>% round(2),

            informative_only_perc = (informative_only_count/total * 100) %>% round(2),
            bar_only_perc = (bar_only_count/total * 100) %>% round(2),
            bar_informative_perc = (bar_informative_count/total * 100) %>% round(2),
  ) %>%
  mutate(year = as.integer(year))



FoR_order <- c("Complementary & Alternative Medicine",
               "Pharmacology & Pharmaceutical Sciences",
               "Biochemistry & Cell Biology",
               "Physiology",
               "Genetics",
               "Oncology & Carcinogenesis",
               "Microbiology",
               "Immunology",
               "Biological Sciences",
               "Nutrition & Dietetics",
               "Medical Biochemistry & Metabolomics",
               "Medical Physiology",
               "Medical Microbiology",
               "Neurosciences",
               "Multidisciplinary Journals",
               "Unclassified Journals",
               "Human Movement & Sports Science",
               "Ophthalmology & Optometry",
               "Cardiorespiratory Medicine & Haematology",
               "Dentistry",
               "Evolutionary Biology",
               "Paediatrics & Reproductive Medicine",
               "Nursing")


pmc2 <-   pmc_results_agg %>%
  filter(year == 2020) %>%
  mutate(bar_perc_sort = bar_perc) %>%
  pivot_longer(cols = c("bar_perc", "informative_perc"),
               names_to = "type",
               values_to = "perc") %>%
  mutate(type = as.factor(type)) %>%
  mutate(type =  fct_reorder(type, desc(type))) %>%
  mutate(FoR_category = as.factor(FoR_category)) %>%
  mutate(FoR_category =  fct_relevel(FoR_category, rev(FoR_order)))


ggplot(pmc2,aes(x = FoR_category,
             y = perc)) +
  geom_col(aes(fill = type),
           position = position_dodge()) +
  geom_vline(xintercept = 21.5, linetype = "dashed") +
  geom_vline(xintercept = 15.5, linetype = "dashed") +
  geom_vline(xintercept = 8.5, linetype = "dashed") +
  annotate("text", x=23, y=80, size = 4, label= "High Priority") +
  annotate("text", x=22, y=80, size = 3, label= "Informative graphs are uncommon",
           color = "gray50") +
  annotate("text", x=19, y=80, size = 4, label= "High Priority") +
  annotate("text", x=18, y=80, size = 3, label= "Informative graphs are common",
           color = "gray50") +
  annotate("text", x=12, y=80, size = 4, label= "Medium Priority") +
  annotate("text", x=4.5, y=80, size = 4, label= "Low Priority") +
  scale_fill_manual(name = "Graph type",
        labels = str_wrap(c("Informative graphs (dot plot, box plot, violin plot, or histogram)",
          "Bar graphs of continuous data"),width = 25),
    values = c("#d0d0d0","#AA493A")) +
  guides(fill = guide_legend(reverse=T)) +
  scale_y_continuous(limits = c(0,100),
      labels = scales::percent_format(
        accuracy = 1, scale = 1),
      expand = c(0,0)) + 
  labs(title = "Identifying fields that would benefit from interventions",
       subtitle = "The fields are divided into three priority groups, depending on the percentage of articles that use <span style='color:#AA493A'>bar graphs of continuous data</span> or <span style='color:gray40'>informative graphs</span>.",
       caption = "Source data: Riedel et al. (2022)",
       x = "",
       y = "Percentage of Papers") +
  coord_flip() +
  theme_us_classic() + 
  theme(legend.position = "none",
        plot.margin = margin(l = 8,
          r = 20, t = 5),
        plot.title.position = "plot",
        plot.title = element_text(
          size = 18, family = "serif", face = "bold"
        ),
        plot.subtitle = element_textbox_simple(
        size = 16, lineheight = 1, family = "serif",
        margin = margin(t = 8, b = 5)
        ), axis.title.x = element_text(hjust = 0),
        plot.caption.position = "plot", 
        plot.caption = element_text(size = 12,
        color = "gray50", hjust = 0,family = "serif"))

#ggsave("bar.png", width = 10, 
#       height = 8, dpi = 300)


```

Figure \@ref(fig:fnt2) displays a horizontally oriented bar chart featuring the theme used throughout the book, which is a variation of ggplot2's `theme_classic()`. Additionally, we've included a title, subtitle, and footnote, giving it an infographic style. The added text elements use the Times New Roman font, and the subtitle incorporates a legend with the colors representing the bars.

## In conclusion {#conclusion12}

In this chapter, we focus on the final two elements of graphic design. While there is a wide variety of themes available to customize your visualizations, we also discover how to make specific adjustments to make your data stand out. We also discuss the possibility of changing the font style; however, to expand the typographic selection, it will be necessary to use the extrafont package.

## To practice!


### Exercise 1

Uses a dataset on body mass index among adults aged 18 years and older according to gender ([CDC, Table A-15](https://archive.cdc.gov/#/details?url=https://www.cdc.gov/nchs/nhis/shs/tables.htm)). Generate a stacked bar chart and label the values with the help of the ggrepel package. You will add a title and subtitle and use a different font.


```{r, warning=FALSE, eval=FALSE,error=FALSE}

library(pacman)
pacman::p_load(
   tidyverse,
   ggtext,
   scales,
   readxl,
   glue,
   ggrepel
  )


b_mass_order <- c(
  "Obese", "Overweight","Normal",
  "Underweight"
)

body_data <- read_xlsx(
  path = "data/Chapter12/body_cdc.xlsx",
  col_names = TRUE) %>% 
  mutate(b_mass_index = as.factor(b_mass_index)) %>%
  mutate(b_mass_index =  fct_relevel(b_mass_index,b_mass_order))
  

```


### Exercise 2


You will use a data set where they evaluated heat inactivation in milk for a panel of different influenza viruses. This includes human and avian influenza A viruses (IAVs), an influenza D virus that naturally infects cattle, and recombinant IAVs carrying contemporary avian or bovine H5N1 glycoproteins [@Schafers2025]. Then you will recreate Figure 2 using the `facet_wrap()` function.


```{r, warning=FALSE, eval=FALSE,error=FALSE}

library(pacman)
pacman::p_load(
   tidyverse,
   scales,
   readxl
  )


milk_data <- read_xlsx(
  path = "data/Chapter12/pasteurisation_milk.xlsx",
  col_names = TRUE, sheet = "Fig 2"
) %>%
  select(-...17, -temp_cat...18,
         -virus...19,-media...20,-time.sec...21,
         -sMean_vt,-SEM,-SD,-n,-author...26,
         -author...9) %>%
  rename(
    time_sec = time.sec...3,
    virus = virus...6,
    temp_cat = temp_cat...15
  ) %>%
  mutate(
    frozen = as.character(frozen),
    temp_cat = recode(
    temp_cat, "63¬∞C" = "63°C"
    ), 
    temp_cat = recode(
    temp_cat, "72¬∞C" = "72°C"
    )
  )

```


