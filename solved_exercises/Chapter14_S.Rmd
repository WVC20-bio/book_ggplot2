---
title: "Chapter14"
author: "William Vilchez Cruz"
date: "2025-02-15"
output: html_document
---

## Exercise 2

```{r}
library(pacman)
pacman::p_load(
   tidyverse,
   ggbeeswarm,
   readxl,
   aplot
  )

lysosomal <-  read_xlsx(
  path = "data/Chapter13/lysosomal_data.xlsx",
  col_names = TRUE, sheet = "data"
)

p1 <- ggplot(lysosomal,
  aes(x = guide_RNA, y = lysosome)) + 
geom_beeswarm(aes(color = expt),
  method = "swarm", alpha = 0.2,
  cex    = 2, size= 2,
  show.legend = FALSE) + 
stat_summary(aes(group = guide_RNA), 
    fun.data = mean_se, geom = 'errorbar', 
    width = 0.1, size = 1, color = "gray50"
  ) +
stat_summary(fun = mean,
    fun.min= mean,
    fun.max = mean,
    geom = "crossbar", 
    size = 0.5, show.legend = FALSE,
    width = 0.25) +
stat_summary(aes(color = expt,
    fill = expt),
 geom = "point", fun = mean, shape = 21,
 size = 5, position = position_jitter(0.1),
 show.legend = FALSE) +
scale_y_continuous(limits = c(0,250),
expand = c(0,0)) + 
scale_x_discrete(labels = c(
  "gNeg", "<span style = 'color:#da6051;'>gNKG7</span>"
)) + 
scale_color_manual(values = c(
  "#0072B2", "#D55E00", "#CC79A7"
)) + 
scale_fill_manual(values = c(
  "#0072B2D0", "#D55E00D0", "#CC79A7D0"
)) +
labs(x = "", y = "Lysosome #",
     title = "CD8<sup>+</sup> T") + 
theme_us_classic() + 
theme(plot.title.position = "plot",
      plot.title = element_markdown(
      color = "#56B4E9", face = "bold",
      size = 18),
      axis.text.x = element_markdown())


p2 <- ggplot(lysosomal,
  aes(x = guide_RNA, y = ratio)) + 
geom_beeswarm(aes(color = expt),
  method = "swarm", alpha = 0.2,
  cex    = 2, size= 2,
  show.legend = FALSE) + 
stat_summary(aes(group = guide_RNA), 
    fun.data = mean_se, geom = 'errorbar', 
    width = 0.1, size = 1, color = "gray50"
  ) +
stat_summary(fun = mean,
    fun.min= mean,
    fun.max = mean,
    geom = "crossbar", 
    size = 0.5, show.legend = FALSE,
    width = 0.25) +
stat_summary(aes(color = expt,
    fill = expt),
 geom = "point", fun = mean, shape = 21,
 size = 5, position = position_jitter(0.1),
 show.legend = FALSE) +
scale_y_continuous(limits = c(0,0.20),
breaks = c(0,0.05,0.10,0.15,0.20), 
labels = c("0","0.05","0.10","0.15","0.20"),
expand = c(0,0)) + 
scale_x_discrete(labels = c(
  "gNeg", "<span style = 'color:#da6051;'>gNKG7</span>"
)) + 
scale_color_manual(values = c(
  "#0072B2", "#D55E00", "#CC79A7"
)) + 
scale_fill_manual(values = c(
  "#0072B2D0", "#D55E00D0", "#CC79A7D0"
)) +
labs(x = "", y = "Ratio (cluster/spot)") + 
theme_us_classic() + 
theme(plot.title.position = "plot",
      plot.title = element_markdown(
      color = "#56B4E9", face = "bold",
      size = 18),
      axis.text.x = element_markdown())

aplot::plot_list(
  p1,p2,ncol = 2)


```























