---
title: "Chapter5"
author: "William Vilchez"
date: "2025-10-04"
output: html_document
---


## Exercise 1


```{r}
library(tidyverse)

w1 =   read.csv2(
"D:/R_scripts/my_book/book_ggplot2/data/Chapter05/winequality-white.csv", 
        header = TRUE)

w2 = read.csv2(
"D:/R_scripts/my_book/book_ggplot2/data/Chapter05/winequality-red.csv", 
        header = TRUE)

w1['type'] <- 'White wine'
w2['type'] <- 'Red wine'

wines <- rbind(w1, w2)

wines_2 <- wines %>%
    dplyr::select(residual.sugar, pH, alcohol,quality, type)

colnames(wines_2) = c("Residual sugar", "pH", "Alcohol", "Quality", "type")

wines_2$`Residual sugar` = as.numeric(wines_2$`Residual sugar`)

wines_2$`pH` = as.numeric(wines_2$`pH`)

wines_2$`Alcohol` = as.numeric(wines_2$`Alcohol`)

wines_2$`Quality` = as.numeric(wines_2$`Quality`)


red_m <- tidyr::pivot_longer(wines_2, c("Alcohol","pH"), 
         names_to = "first_metric", 
         values_to = "first_value")

red_m <- tidyr::pivot_longer(red_m, c("Residual sugar","Quality"),
          names_to = "second_metric", 
          values_to = "second_value")

ggplot(red_m, aes(x = first_value, 
       y = second_value)) + 
geom_point(aes(color=type, fill = type), 
        size = 3, shape = 21, alpha = 0.4) +
  scale_color_manual(
    values = c("#56B4E9","#E69F00"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 2)
      )) + 
geom_smooth(method = "lm",
color = "gray50", size = 1.5) + 
  scale_fill_manual(
    values = c("#56B4E980", "#E69F0080"),
    name = NULL ) +
  facet_grid(second_metric ~ first_metric, 
          scales = "free",switch = "both") + 
  theme(strip.placement = "outside",
    strip.background = element_blank(),
    strip.text = element_text(size = 14),
    axis.title = element_blank(),
    legend.position = "top",
    legend.key = element_blank(),
    legend.justification = "left",
    legend.text = element_text(size = 14),
    panel.border = element_rect(colour = "black",
    fill = NA), 
    panel.background = element_blank(),
    plot.margin = margin(14, 7, 3, 1.5))

```






